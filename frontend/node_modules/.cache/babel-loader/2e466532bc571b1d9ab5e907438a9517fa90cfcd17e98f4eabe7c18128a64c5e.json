{"ast":null,"code":"var _jsxFileName = \"D:\\\\my_company\\\\final_Ecommerce\\\\Skyup_Ecommerce_Front_End\\\\frontend\\\\src\\\\Context\\\\ShopContext.jsx\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ShopContext = /*#__PURE__*/createContext(null);\nconst getDefaultCart = products => {\n  const cart = {};\n  products.forEach(product => {\n    cart[product.id] = 0;\n  });\n  return cart;\n};\nconst ShopContextProvider = ({\n  children\n}) => {\n  _s();\n  const [all_product, setAll_Product] = useState([]);\n  const [cartItems, setCartItems] = useState({});\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    const fetchProductsAndCart = async () => {\n      try {\n        setLoading(true);\n        const res = await fetch('http://localhost:8070/items');\n        const data = await res.json();\n        const formattedData = data.map(product => ({\n          ...product,\n          id: product._id\n        }));\n        setAll_Product(formattedData);\n        const token = localStorage.getItem('auth-token');\n        if (token) {\n          const cartRes = await fetch('http://localhost:8070/carts', {\n            method: 'GET',\n            headers: {\n              'auth-token': token,\n              'Content-Type': 'application/json'\n            }\n          });\n          const cart = await cartRes.json();\n          const cartObj = getDefaultCart(formattedData);\n          cart.items.forEach(({\n            itemId,\n            quantity\n          }) => {\n            cartObj[itemId._id] = quantity;\n          });\n          setCartItems(cartObj);\n        } else {\n          const storedCart = JSON.parse(localStorage.getItem('cart')) || {};\n          setCartItems(storedCart);\n        }\n      } catch (err) {\n        console.error('Error fetching products or cart:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchProductsAndCart();\n  }, []);\n  const addToCart = itemId => {\n    const updatedCart = {\n      ...cartItems,\n      [itemId]: (cartItems[itemId] || 0) + 1\n    };\n    setCartItems(updatedCart);\n    localStorage.setItem('cart', JSON.stringify(updatedCart));\n    const token = localStorage.getItem('auth-token');\n    if (token) {\n      fetch('http://localhost:8070/carts', {\n        method: 'POST',\n        headers: {\n          'auth-token': token,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          itemId,\n          quantity: 1\n        })\n      }).catch(err => console.error('Add to cart error:', err));\n    }\n  };\n  const removeFromCart = itemId => {\n    const updatedCart = {\n      ...cartItems\n    };\n    const newCount = (updatedCart[itemId] || 1) - 1;\n    if (newCount > 0) {\n      updatedCart[itemId] = newCount;\n    } else {\n      delete updatedCart[itemId];\n    }\n    setCartItems(updatedCart);\n    localStorage.setItem('cart', JSON.stringify(updatedCart));\n    const token = localStorage.getItem('auth-token');\n    if (token) {\n      fetch(`http://localhost:8070/carts/${itemId}`, {\n        method: 'DELETE',\n        headers: {\n          'auth-token': token,\n          'Content-Type': 'application/json'\n        }\n      }).catch(err => console.error('Remove from cart error:', err));\n    }\n  };\n  const updateCartItem = (itemId, quantity) => {\n    const updatedCart = {\n      ...cartItems,\n      [itemId]: quantity\n    };\n    setCartItems(updatedCart);\n    localStorage.setItem('cart', JSON.stringify(updatedCart));\n    const token = localStorage.getItem('auth-token');\n    if (token) {\n      fetch(`http://localhost:8070/carts/${itemId}`, {\n        method: 'PUT',\n        headers: {\n          'auth-token': token,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          quantity\n        })\n      }).catch(err => console.error('Update quantity error:', err));\n    }\n  };\n  const getTotalCartItems = () => {\n    return Object.values(cartItems).reduce((sum, qty) => sum + qty, 0);\n  };\n  const contextValue = {\n    all_product,\n    cartItems,\n    addToCart,\n    removeFromCart,\n    updateCartItem,\n    getTotalCartItems,\n    loading\n  };\n  return /*#__PURE__*/_jsxDEV(ShopContext.Provider, {\n    value: contextValue,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 5\n  }, this);\n};\n_s(ShopContextProvider, \"ugY8iPpBPkALW3sdB2/dnSzxZpk=\");\n_c = ShopContextProvider;\nexport default ShopContextProvider;\nvar _c;\n$RefreshReg$(_c, \"ShopContextProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","jsxDEV","_jsxDEV","ShopContext","getDefaultCart","products","cart","forEach","product","id","ShopContextProvider","children","_s","all_product","setAll_Product","cartItems","setCartItems","loading","setLoading","fetchProductsAndCart","res","fetch","data","json","formattedData","map","_id","token","localStorage","getItem","cartRes","method","headers","cartObj","items","itemId","quantity","storedCart","JSON","parse","err","console","error","addToCart","updatedCart","setItem","stringify","body","catch","removeFromCart","newCount","updateCartItem","getTotalCartItems","Object","values","reduce","sum","qty","contextValue","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/my_company/final_Ecommerce/Skyup_Ecommerce_Front_End/frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\n\r\nexport const ShopContext = createContext(null);\r\n\r\nconst getDefaultCart = (products) => {\r\n  const cart = {};\r\n  products.forEach((product) => {\r\n    cart[product.id] = 0;\r\n  });\r\n  return cart;\r\n};\r\n\r\nconst ShopContextProvider = ({ children }) => {\r\n  const [all_product, setAll_Product] = useState([]);\r\n  const [cartItems, setCartItems] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchProductsAndCart = async () => {\r\n      try {\r\n        setLoading(true);\r\n\r\n        const res = await fetch('http://localhost:8070/items');\r\n        const data = await res.json();\r\n\r\n        const formattedData = data.map((product) => ({\r\n          ...product,\r\n          id: product._id,\r\n        }));\r\n\r\n        setAll_Product(formattedData);\r\n\r\n        const token = localStorage.getItem('auth-token');\r\n        if (token) {\r\n          const cartRes = await fetch('http://localhost:8070/carts', {\r\n            method: 'GET',\r\n            headers: {\r\n              'auth-token': token,\r\n              'Content-Type': 'application/json',\r\n            },\r\n          });\r\n\r\n          const cart = await cartRes.json();\r\n          const cartObj = getDefaultCart(formattedData);\r\n          cart.items.forEach(({ itemId, quantity }) => {\r\n            cartObj[itemId._id] = quantity;\r\n          });\r\n\r\n          setCartItems(cartObj);\r\n        } else {\r\n          const storedCart = JSON.parse(localStorage.getItem('cart')) || {};\r\n          setCartItems(storedCart);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error fetching products or cart:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProductsAndCart();\r\n  }, []);\r\n\r\n  const addToCart = (itemId) => {\r\n    const updatedCart = {\r\n      ...cartItems,\r\n      [itemId]: (cartItems[itemId] || 0) + 1,\r\n    };\r\n    setCartItems(updatedCart);\r\n    localStorage.setItem('cart', JSON.stringify(updatedCart));\r\n\r\n    const token = localStorage.getItem('auth-token');\r\n    if (token) {\r\n      fetch('http://localhost:8070/carts', {\r\n        method: 'POST',\r\n        headers: {\r\n          'auth-token': token,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ itemId, quantity: 1 }),\r\n      }).catch((err) => console.error('Add to cart error:', err));\r\n    }\r\n  };\r\n\r\n  const removeFromCart = (itemId) => {\r\n    const updatedCart = { ...cartItems };\r\n    const newCount = (updatedCart[itemId] || 1) - 1;\r\n    if (newCount > 0) {\r\n      updatedCart[itemId] = newCount;\r\n    } else {\r\n      delete updatedCart[itemId];\r\n    }\r\n    setCartItems(updatedCart);\r\n    localStorage.setItem('cart', JSON.stringify(updatedCart));\r\n\r\n    const token = localStorage.getItem('auth-token');\r\n    if (token) {\r\n      fetch(`http://localhost:8070/carts/${itemId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'auth-token': token,\r\n          'Content-Type': 'application/json',\r\n        },\r\n      }).catch((err) => console.error('Remove from cart error:', err));\r\n    }\r\n  };\r\n\r\n  const updateCartItem = (itemId, quantity) => {\r\n    const updatedCart = {\r\n      ...cartItems,\r\n      [itemId]: quantity,\r\n    };\r\n    setCartItems(updatedCart);\r\n    localStorage.setItem('cart', JSON.stringify(updatedCart));\r\n\r\n    const token = localStorage.getItem('auth-token');\r\n    if (token) {\r\n      fetch(`http://localhost:8070/carts/${itemId}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'auth-token': token,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ quantity }),\r\n      }).catch((err) => console.error('Update quantity error:', err));\r\n    }\r\n  };\r\n\r\n  const getTotalCartItems = () => {\r\n    return Object.values(cartItems).reduce((sum, qty) => sum + qty, 0);\r\n  };\r\n\r\n  const contextValue = {\r\n    all_product,\r\n    cartItems,\r\n    addToCart,\r\n    removeFromCart,\r\n    updateCartItem,\r\n    getTotalCartItems,\r\n    loading,\r\n  };\r\n\r\n  return (\r\n    <ShopContext.Provider value={contextValue}>\r\n      {children}\r\n    </ShopContext.Provider>\r\n  );\r\n};\r\n\r\nexport default ShopContextProvider;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}